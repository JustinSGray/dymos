

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Multi-Phase Cannonball &#8212; dymos 0.11.1 documentation</title>
    <link rel="stylesheet" href="../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Two-Burn Orbit Raise" href="two_burn_orbit_raise.html" />
    <link rel="prev" title="Commercial Aircraft Range Maximization by Differential Inclusion" href="commercial_aircraft.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="two_burn_orbit_raise.html" title="Two-Burn Orbit Raise"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="commercial_aircraft.html" title="Commercial Aircraft Range Maximization by Differential Inclusion"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">dymos 0.11.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="examples.html" accesskey="U">Examples</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Multi-Phase Cannonball</a><ul>
<li><a class="reference internal" href="#using-two-phases-to-capture-an-intermediate-boundary-constraint">Using two phases to capture an intermediate boundary constraint</a></li>
<li><a class="reference internal" href="#designing-a-cannonball-for-maximum-range">Designing a cannonball for maximum range</a></li>
<li><a class="reference internal" href="#building-and-running-the-problem">Building and running the problem</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="commercial_aircraft.html"
                        title="previous chapter">Commercial Aircraft Range Maximization by Differential Inclusion</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="two_burn_orbit_raise.html"
                        title="next chapter">Two-Burn Orbit Raise</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/examples/multi_phase_cannonball.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="multi-phase-cannonball">
<h1>Multi-Phase Cannonball<a class="headerlink" href="#multi-phase-cannonball" title="Permalink to this headline">¶</a></h1>
<p>This example demonstrates the use of a Trajectory to encapsulate phases for a simple max-range
cannonball case.</p>
<div class="section" id="using-two-phases-to-capture-an-intermediate-boundary-constraint">
<h2>Using two phases to capture an intermediate boundary constraint<a class="headerlink" href="#using-two-phases-to-capture-an-intermediate-boundary-constraint" title="Permalink to this headline">¶</a></h2>
<p>This problem demonstrates the use of two phases to capture the state of the system at an event
in the trajectory.  Here, we have the first phase (ascent) terminate when the flight path
angle reaches zero (apogee).  The descent phase follows until the cannonball impacts the ground.</p>
<p>The dynamics are given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{d v}{d t} &amp;= \frac{T}{m} \cos(\alpha) - \frac{D}{m} - g \sin(\gamma) \\
\frac{d \gamma}{d t} &amp;= \frac{T}{mv} \sin(\alpha) + \frac{L}{mv} - \frac{g \cos(\gamma)}{v} \\
\frac{d h}{d t} &amp;= v \sin(\gamma) \\
\frac{d r}{d t} &amp;= v \cos(\gamma)\end{split}\]</div>
<p>The initial conditions are</p>
<div class="math notranslate nohighlight">
\[\begin{split}r_0 &amp;= 0 \, \mathrm{m} \\
h_0 &amp;= 100 \, \mathrm{m} \\
v_0 &amp;= \mathrm{free} \\
\gamma_0 &amp;= \mathrm{free} \\\end{split}\]</div>
<p>and the final conditions are</p>
<div class="math notranslate nohighlight">
\[h_f &amp;= 0 \, \mathrm{m}\]</div>
</div>
<div class="section" id="designing-a-cannonball-for-maximum-range">
<h2>Designing a cannonball for maximum range<a class="headerlink" href="#designing-a-cannonball-for-maximum-range" title="Permalink to this headline">¶</a></h2>
<p>This problem demonstrates a very simple vehicle design capability that is run
before the trajectory.</p>
<p>We assume our cannon can shoot a cannonball with some fixed kinetic energy and that
our cannonball is made of solid iron.  The volume (and mass) of the cannonball is proportional
to its radius cubed, while the cross-sectional area is proportional to its radius squared.
If we increase the size of the cannonball, the ballistic coefficient</p>
<div class="math notranslate nohighlight">
\[BC = \frac{m}{C_D A}\]</div>
<p>will increase, meaning the cannonball overcome air resistance more easily and thus carry more distance.</p>
<p>However, making the cannonball larger also increases its mass.  Our cannon can impart the cannonball
with, at most, 400 kJ of kinetic energy.  So making the cannonball larger will decrease the
initial velocity, and thus negatively impact its range.</p>
<p>We therefore have a design that affects the objective in competing ways.  We cannot make the
cannonball too large, as it will be too heavy to shoot.  We also cannot make the cannonball too
small, as it will be more susceptible to air resistance.  Somewhere in between is the sweet spot
that provides the maximum range cannonball.</p>
</div>
<div class="section" id="building-and-running-the-problem">
<h2>Building and running the problem<a class="headerlink" href="#building-and-running-the-problem" title="Permalink to this headline">¶</a></h2>
<p>The following code instantiates our problem, our trajectory, two phases, and links them
accordingly.  The initial flight path angle is free, since 45 degrees is not necessarily optimal
once air resistance is taken into account.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openmdao.api</span> <span class="kn">import</span> <span class="n">Problem</span><span class="p">,</span> <span class="n">Group</span><span class="p">,</span> <span class="n">IndepVarComp</span><span class="p">,</span> <span class="n">DirectSolver</span><span class="p">,</span> <span class="n">SqliteRecorder</span><span class="p">,</span> \
    <span class="n">pyOptSparseDriver</span>
<span class="kn">from</span> <span class="nn">openmdao.utils.assert_utils</span> <span class="kn">import</span> <span class="n">assert_rel_error</span>

<span class="kn">from</span> <span class="nn">dymos</span> <span class="kn">import</span> <span class="n">Phase</span><span class="p">,</span> <span class="n">Trajectory</span><span class="p">,</span> <span class="n">load_simulation_results</span>
<span class="kn">from</span> <span class="nn">dymos.examples.cannonball.cannonball_ode</span> <span class="kn">import</span> <span class="n">CannonballODE</span>

<span class="kn">from</span> <span class="nn">dymos.examples.cannonball.size_comp</span> <span class="kn">import</span> <span class="n">CannonballSizeComp</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">Problem</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">Group</span><span class="p">())</span>

<span class="n">p</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">pyOptSparseDriver</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;optimizer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SLSQP&#39;</span>
<span class="n">p</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;dynamic_simul_derivs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>

<span class="n">external_params</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;external_params&#39;</span><span class="p">,</span> <span class="n">IndepVarComp</span><span class="p">())</span>

<span class="n">external_params</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;radius&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.10</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">external_params</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;dens&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">7.87</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;g/cm**3&#39;</span><span class="p">)</span>

<span class="n">external_params</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;radius&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.10</span><span class="p">,</span> <span class="n">ref0</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="mf">0.10</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;size_comp&#39;</span><span class="p">,</span> <span class="n">CannonballSizeComp</span><span class="p">())</span>

<span class="n">traj</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;traj&#39;</span><span class="p">,</span> <span class="n">Trajectory</span><span class="p">())</span>

<span class="c1"># First Phase (ascent)</span>
<span class="n">ascent</span> <span class="o">=</span> <span class="n">Phase</span><span class="p">(</span><span class="s1">&#39;radau-ps&#39;</span><span class="p">,</span>
               <span class="n">ode_class</span><span class="o">=</span><span class="n">CannonballODE</span><span class="p">,</span>
               <span class="n">num_segments</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
               <span class="n">transcription_order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
               <span class="n">compressed</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">ascent</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">add_phase</span><span class="p">(</span><span class="s1">&#39;ascent&#39;</span><span class="p">,</span> <span class="n">ascent</span><span class="p">)</span>

<span class="c1"># All initial states except flight path angle are fixed</span>
<span class="c1"># Final flight path angle is fixed (we will set it to zero so that the phase ends at apogee)</span>
<span class="n">ascent</span><span class="o">.</span><span class="n">set_time_options</span><span class="p">(</span><span class="n">fix_initial</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">duration_bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">duration_ref</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ascent</span><span class="o">.</span><span class="n">set_state_options</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">fix_initial</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">fix_final</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ascent</span><span class="o">.</span><span class="n">set_state_options</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">fix_initial</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">fix_final</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ascent</span><span class="o">.</span><span class="n">set_state_options</span><span class="p">(</span><span class="s1">&#39;gam&#39;</span><span class="p">,</span> <span class="n">fix_initial</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">fix_final</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ascent</span><span class="o">.</span><span class="n">set_state_options</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">fix_initial</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">fix_final</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c1"># Limit the muzzle energy</span>
<span class="n">ascent</span><span class="o">.</span><span class="n">add_boundary_constraint</span><span class="p">(</span><span class="s1">&#39;kinetic_energy.ke&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;initial&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;J&#39;</span><span class="p">,</span>
                               <span class="n">upper</span><span class="o">=</span><span class="mi">400000</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>

<span class="c1"># Second Phase (descent)</span>
<span class="n">descent</span> <span class="o">=</span> <span class="n">Phase</span><span class="p">(</span><span class="s1">&#39;gauss-lobatto&#39;</span><span class="p">,</span>
                <span class="n">ode_class</span><span class="o">=</span><span class="n">CannonballODE</span><span class="p">,</span>
                <span class="n">num_segments</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                <span class="n">transcription_order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                <span class="n">compressed</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">traj</span><span class="o">.</span><span class="n">add_phase</span><span class="p">(</span><span class="s1">&#39;descent&#39;</span><span class="p">,</span> <span class="n">descent</span><span class="p">)</span>

<span class="c1"># All initial states and time are free (they will be linked to the final states of ascent.</span>
<span class="c1"># Final altitude is fixed (we will set it to zero so that the phase ends at ground impact)</span>
<span class="n">descent</span><span class="o">.</span><span class="n">set_time_options</span><span class="p">(</span><span class="n">initial_bounds</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">duration_bounds</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
                         <span class="n">duration_ref</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">descent</span><span class="o">.</span><span class="n">set_state_options</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">fix_initial</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">fix_final</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">descent</span><span class="o">.</span><span class="n">set_state_options</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">fix_initial</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">fix_final</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">descent</span><span class="o">.</span><span class="n">set_state_options</span><span class="p">(</span><span class="s1">&#39;gam&#39;</span><span class="p">,</span> <span class="n">fix_initial</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">fix_final</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">descent</span><span class="o">.</span><span class="n">set_state_options</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">fix_initial</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">fix_final</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">descent</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;final&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># Add internally-managed design parameters to the trajectory.</span>
<span class="n">traj</span><span class="o">.</span><span class="n">add_design_parameter</span><span class="p">(</span><span class="s1">&#39;CD&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">traj</span><span class="o">.</span><span class="n">add_design_parameter</span><span class="p">(</span><span class="s1">&#39;CL&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">traj</span><span class="o">.</span><span class="n">add_design_parameter</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">traj</span><span class="o">.</span><span class="n">add_design_parameter</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c1"># Add externally-provided design parameters to the trajectory.</span>
<span class="n">traj</span><span class="o">.</span><span class="n">add_input_parameter</span><span class="p">(</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span>
                         <span class="n">targets</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ascent&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;descent&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">},</span>
                         <span class="n">val</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                         <span class="n">units</span><span class="o">=</span><span class="s1">&#39;kg&#39;</span><span class="p">)</span>

<span class="n">traj</span><span class="o">.</span><span class="n">add_input_parameter</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m**2&#39;</span><span class="p">)</span>

<span class="c1"># Link Phases (link time and all state variables)</span>
<span class="n">traj</span><span class="o">.</span><span class="n">link_phases</span><span class="p">(</span><span class="n">phases</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ascent&#39;</span><span class="p">,</span> <span class="s1">&#39;descent&#39;</span><span class="p">],</span> <span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>

<span class="c1"># Issue Connections</span>
<span class="n">p</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;external_params.radius&#39;</span><span class="p">,</span> <span class="s1">&#39;size_comp.radius&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;external_params.dens&#39;</span><span class="p">,</span> <span class="s1">&#39;size_comp.dens&#39;</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;size_comp.mass&#39;</span><span class="p">,</span> <span class="s1">&#39;traj.input_parameters:mass&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;size_comp.S&#39;</span><span class="p">,</span> <span class="s1">&#39;traj.input_parameters:S&#39;</span><span class="p">)</span>

<span class="c1"># Finish Problem Setup</span>
<span class="n">p</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;assembled_jac_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;csc&#39;</span>
<span class="n">p</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">linear_solver</span> <span class="o">=</span> <span class="n">DirectSolver</span><span class="p">(</span><span class="n">assemble_jac</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_recorder</span><span class="p">(</span><span class="n">SqliteRecorder</span><span class="p">(</span><span class="s1">&#39;ex_two_phase_cannonball.db&#39;</span><span class="p">))</span>

<span class="n">p</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># Set Initial Guesses</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;external_params.radius&#39;</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;external_params.dens&#39;</span><span class="p">,</span> <span class="mf">7.87</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;g/cm**3&#39;</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.design_parameters:CD&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.design_parameters:CL&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.design_parameters:T&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.t_initial&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.t_duration&#39;</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.states:r&#39;</span><span class="p">,</span> <span class="n">ascent</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">ys</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">nodes</span><span class="o">=</span><span class="s1">&#39;state_input&#39;</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.states:h&#39;</span><span class="p">,</span> <span class="n">ascent</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">ys</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">nodes</span><span class="o">=</span><span class="s1">&#39;state_input&#39;</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.states:v&#39;</span><span class="p">,</span> <span class="n">ascent</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">ys</span><span class="o">=</span><span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">150</span><span class="p">],</span> <span class="n">nodes</span><span class="o">=</span><span class="s1">&#39;state_input&#39;</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.states:gam&#39;</span><span class="p">,</span> <span class="n">ascent</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">ys</span><span class="o">=</span><span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">nodes</span><span class="o">=</span><span class="s1">&#39;state_input&#39;</span><span class="p">),</span>
          <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.t_initial&#39;</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.t_duration&#39;</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.states:r&#39;</span><span class="p">,</span> <span class="n">descent</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">ys</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="n">nodes</span><span class="o">=</span><span class="s1">&#39;state_input&#39;</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.states:h&#39;</span><span class="p">,</span> <span class="n">descent</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">ys</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">nodes</span><span class="o">=</span><span class="s1">&#39;state_input&#39;</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.states:v&#39;</span><span class="p">,</span> <span class="n">descent</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">ys</span><span class="o">=</span><span class="p">[</span><span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="n">nodes</span><span class="o">=</span><span class="s1">&#39;state_input&#39;</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_val</span><span class="p">(</span><span class="s1">&#39;traj.descent.states:gam&#39;</span><span class="p">,</span> <span class="n">descent</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">ys</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">45</span><span class="p">],</span> <span class="n">nodes</span><span class="o">=</span><span class="s1">&#39;state_input&#39;</span><span class="p">),</span>
          <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">run_driver</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)[</span><span class="s1">&#39;descent&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="n">exp_out</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">record_file</span><span class="o">=</span><span class="s1">&#39;ex_two_phase_cannonball_sim.db&#39;</span><span class="p">)</span>

<span class="c1"># exp_out_loaded = load_simulation_results(&#39;ex_two_phase_cannonball_sim.db&#39;)</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;optimal radius: {0:6.4f} m &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;external_params.radius&#39;</span><span class="p">,</span>
                                                     <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;cannonball mass: {0:6.4f} kg &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;size_comp.mass&#39;</span><span class="p">,</span>
                                                       <span class="n">units</span><span class="o">=</span><span class="s1">&#39;kg&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span>
             <span class="n">traj</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span>
             <span class="s1">&#39;bo&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span>
             <span class="n">traj</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span>
             <span class="s1">&#39;ro&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">exp_out</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span>
             <span class="n">exp_out</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span>
             <span class="s1">&#39;b--&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">exp_out</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span>
             <span class="n">exp_out</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span>
             <span class="s1">&#39;r--&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;range (m)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;altitude (m)&#39;</span><span class="p">)</span>

<span class="c1"># plt.suptitle(&#39;Kinetic Energy vs Time&#39;)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span>
             <span class="n">traj</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;kinetic_energy.ke&#39;</span><span class="p">)[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span>
             <span class="s1">&#39;bo&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span>
             <span class="n">traj</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;kinetic_energy.ke&#39;</span><span class="p">)[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span>
             <span class="s1">&#39;ro&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">exp_out</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span>
             <span class="n">exp_out</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;kinetic_energy.ke&#39;</span><span class="p">)[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span>
             <span class="s1">&#39;b--&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">exp_out</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span>
             <span class="n">exp_out</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;kinetic_energy.ke&#39;</span><span class="p">)[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span>
             <span class="s1">&#39;r--&#39;</span><span class="p">)</span>

<span class="c1"># axes[1].plot(exp_out_loaded.get_values(&#39;time&#39;)[&#39;ascent&#39;],</span>
<span class="c1">#              exp_out_loaded.get_values(&#39;kinetic_energy.ke&#39;)[&#39;ascent&#39;],</span>
<span class="c1">#              &#39;b--&#39;)</span>
<span class="c1">#</span>
<span class="c1"># axes[1].plot(exp_out_loaded.get_values(&#39;time&#39;)[&#39;descent&#39;],</span>
<span class="c1">#              exp_out_loaded.get_values(&#39;kinetic_energy.ke&#39;)[&#39;descent&#39;],</span>
<span class="c1">#              &#39;r--&#39;)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;kinetic energy (J)&#39;</span><span class="p">)</span>

<span class="c1"># plt.figure()</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span>
             <span class="n">traj</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;gam&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span>
             <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span>
             <span class="n">traj</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;gam&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span>
             <span class="s1">&#39;ro&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">exp_out</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span>
             <span class="n">exp_out</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;gam&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)[</span><span class="s1">&#39;ascent&#39;</span><span class="p">],</span>
             <span class="s1">&#39;b--&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">exp_out</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span>
             <span class="n">exp_out</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="s1">&#39;gam&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)[</span><span class="s1">&#39;descent&#39;</span><span class="p">],</span>
             <span class="s1">&#39;r--&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;flight path angle (deg)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>--- Linkage Report [traj] ---
   ascent     descent
       states:v++    --&gt; states:v--   
       states:gam++  --&gt; states:gam-- 
       states:h++    --&gt; states:h--   
       time++        --&gt; time--       
       states:r++    --&gt; states:r--   
----------------------------

Using tolerance: 1e-17
Most common number of zero entries (7038 of 7656) repeated 8 times out of 11 tolerances tested.

Full total jacobian was computed 3 times, taking 0.048023 seconds.
Total jacobian shape: (87, 88) 



Optimization Problem -- Optimization using pyOpt_sparse
================================================================================
    Objective Function: _objfunc

    Solution: 
--------------------------------------------------------------------------------
    Total Time:                    3.4664
       User Objective Time :       1.6455
       User Sensitivity Time :     0.9200
       Interface Time :            0.6657
       Opt Solver Time:            0.2352
    Calls to Objective Function :     137
    Calls to Sens Function :          102


   Objectives
      Index  Name                                                 Value          Optimum
          0  traj.phases.descent.indep_states.states:r    -3.191839E+03     0.000000E+00

   Variables (c - continuous, i - integer, d - discrete)
      Index  Name                                            Type      Lower Bound            Value      Upper Bound     Status
          0  external_params.radius_0                           c     0.000000E+00     3.535021E-01     1.000000E+00           
          1  traj.phases.ascent.time_extents.t_duration_0       c     1.000000E-02     1.066529E-01     1.000000E+00           
          2  traj.phases.ascent.indep_states.states:v_0         c    -1.000000E+21     5.761191E+02     1.000000E+21           
          3  traj.phases.ascent.indep_states.states:v_1         c    -1.000000E+21     4.382750E+02     1.000000E+21           
          4  traj.phases.ascent.indep_states.states:v_2         c    -1.000000E+21     3.338053E+02     1.000000E+21           
          5  traj.phases.ascent.indep_states.states:v_3         c    -1.000000E+21     3.075080E+02     1.000000E+21           
          6  traj.phases.ascent.indep_states.states:v_4         c    -1.000000E+21     2.631714E+02     1.000000E+21           
          7  traj.phases.ascent.indep_states.states:v_5         c    -1.000000E+21     2.192509E+02     1.000000E+21           
          8  traj.phases.ascent.indep_states.states:v_6         c    -1.000000E+21     2.078858E+02     1.000000E+21           
          9  traj.phases.ascent.indep_states.states:v_7         c    -1.000000E+21     1.858514E+02     1.000000E+21           
         10  traj.phases.ascent.indep_states.states:v_8         c    -1.000000E+21     1.618735E+02     1.000000E+21           
         11  traj.phases.ascent.indep_states.states:v_9         c    -1.000000E+21     1.554261E+02     1.000000E+21           
         12  traj.phases.ascent.indep_states.states:v_10        c    -1.000000E+21     1.424488E+02     1.000000E+21           
         13  traj.phases.ascent.indep_states.states:v_11        c    -1.000000E+21     1.278344E+02     1.000000E+21           
         14  traj.phases.ascent.indep_states.states:v_12        c    -1.000000E+21     1.238612E+02     1.000000E+21           
         15  traj.phases.ascent.indep_states.states:v_13        c    -1.000000E+21     1.158216E+02     1.000000E+21           
         16  traj.phases.ascent.indep_states.states:v_14        c    -1.000000E+21     1.068385E+02     1.000000E+21           
         17  traj.phases.ascent.indep_states.states:v_15        c    -1.000000E+21     1.044448E+02     1.000000E+21           
         18  traj.phases.ascent.indep_states.states:gam_0       c    -1.000000E+21     5.589975E-01     1.000000E+21           
         19  traj.phases.ascent.indep_states.states:gam_1       c    -1.000000E+21     5.462879E-01     1.000000E+21           
         20  traj.phases.ascent.indep_states.states:gam_2       c    -1.000000E+21     5.229865E-01     1.000000E+21           
         21  traj.phases.ascent.indep_states.states:gam_3       c    -1.000000E+21     5.142425E-01     1.000000E+21           
         22  traj.phases.ascent.indep_states.states:gam_4       c    -1.000000E+21     4.912995E-01     1.000000E+21           
         23  traj.phases.ascent.indep_states.states:gam_5       c    -1.000000E+21     4.531552E-01     1.000000E+21           
         24  traj.phases.ascent.indep_states.states:gam_6       c    -1.000000E+21     4.394579E-01     1.000000E+21           
         25  traj.phases.ascent.indep_states.states:gam_7       c    -1.000000E+21     4.049423E-01     1.000000E+21           
         26  traj.phases.ascent.indep_states.states:gam_8       c    -1.000000E+21     3.499070E-01     1.000000E+21           
         27  traj.phases.ascent.indep_states.states:gam_9       c    -1.000000E+21     3.306296E-01     1.000000E+21           
         28  traj.phases.ascent.indep_states.states:gam_10      c    -1.000000E+21     2.830018E-01     1.000000E+21           
         29  traj.phases.ascent.indep_states.states:gam_11      c    -1.000000E+21     2.092617E-01     1.000000E+21           
         30  traj.phases.ascent.indep_states.states:gam_12      c    -1.000000E+21     1.839733E-01     1.000000E+21           
         31  traj.phases.ascent.indep_states.states:gam_13      c    -1.000000E+21     1.226445E-01     1.000000E+21           
         32  traj.phases.ascent.indep_states.states:gam_14      c    -1.000000E+21     3.071631E-02     1.000000E+21           
         33  traj.phases.ascent.indep_states.states:h_0         c    -1.000000E+21     2.001338E+02     1.000000E+21           
         34  traj.phases.ascent.indep_states.states:h_1         c    -1.000000E+21     4.015234E+02     1.000000E+21           
         35  traj.phases.ascent.indep_states.states:h_2         c    -1.000000E+21     4.551809E+02     1.000000E+21           
         36  traj.phases.ascent.indep_states.states:h_3         c    -1.000000E+21     5.591175E+02     1.000000E+21           
         37  traj.phases.ascent.indep_states.states:h_4         c    -1.000000E+21     6.732103E+02     1.000000E+21           
         38  traj.phases.ascent.indep_states.states:h_5         c    -1.000000E+21     7.038217E+02     1.000000E+21           
         39  traj.phases.ascent.indep_states.states:h_6         c    -1.000000E+21     7.649131E+02     1.000000E+21           
         40  traj.phases.ascent.indep_states.states:h_7         c    -1.000000E+21     8.318320E+02     1.000000E+21           
         41  traj.phases.ascent.indep_states.states:h_8         c    -1.000000E+21     8.493778E+02     1.000000E+21           
         42  traj.phases.ascent.indep_states.states:h_9         c    -1.000000E+21     8.834889E+02     1.000000E+21           
         43  traj.phases.ascent.indep_states.states:h_10        c    -1.000000E+21     9.179945E+02     1.000000E+21           
         44  traj.phases.ascent.indep_states.states:h_11        c    -1.000000E+21     9.261411E+02     1.000000E+21           
         45  traj.phases.ascent.indep_states.states:h_12        c    -1.000000E+21     9.400552E+02     1.000000E+21           
         46  traj.phases.ascent.indep_states.states:h_13        c    -1.000000E+21     9.490895E+02     1.000000E+21           
         47  traj.phases.ascent.indep_states.states:h_14        c    -1.000000E+21     9.496352E+02     1.000000E+21           
         48  traj.phases.ascent.indep_states.states:r_0         c    -1.000000E+21     3.239974E+02     1.000000E+21           
         49  traj.phases.ascent.indep_states.states:r_1         c    -1.000000E+21     6.634993E+02     1.000000E+21           
         50  traj.phases.ascent.indep_states.states:r_2         c    -1.000000E+21     7.573206E+02     1.000000E+21           
         51  traj.phases.ascent.indep_states.states:r_3         c    -1.000000E+21     9.460228E+02     1.000000E+21           
         52  traj.phases.ascent.indep_states.states:r_4         c    -1.000000E+21     1.168811E+03     1.000000E+21           
         53  traj.phases.ascent.indep_states.states:r_5         c    -1.000000E+21     1.232704E+03     1.000000E+21           
         54  traj.phases.ascent.indep_states.states:r_6         c    -1.000000E+21     1.368433E+03     1.000000E+21           
         55  traj.phases.ascent.indep_states.states:r_7         c    -1.000000E+21     1.536619E+03     1.000000E+21           
         56  traj.phases.ascent.indep_states.states:r_8         c    -1.000000E+21     1.586119E+03     1.000000E+21           
         57  traj.phases.ascent.indep_states.states:r_9         c    -1.000000E+21     1.693491E+03     1.000000E+21           
         58  traj.phases.ascent.indep_states.states:r_10        c    -1.000000E+21     1.830054E+03     1.000000E+21           
         59  traj.phases.ascent.indep_states.states:r_11        c    -1.000000E+21     1.870884E+03     1.000000E+21           
         60  traj.phases.ascent.indep_states.states:r_12        c    -1.000000E+21     1.960476E+03     1.000000E+21           
         61  traj.phases.ascent.indep_states.states:r_13        c    -1.000000E+21     2.076207E+03     1.000000E+21           
         62  traj.phases.ascent.indep_states.states:r_14        c    -1.000000E+21     2.111144E+03     1.000000E+21           
         63  traj.phases.descent.time_extents.t_initial_0       c     5.000000E-01     1.066529E+01     1.000000E+02           
         64  traj.phases.descent.time_extents.t_duration_0      c     5.000000E-03     1.619769E-01     1.000000E+00           
         65  traj.phases.descent.indep_states.states:v_0        c    -1.000000E+21     1.044448E+02     1.000000E+21           
         66  traj.phases.descent.indep_states.states:v_1        c    -1.000000E+21     9.043368E+01     1.000000E+21           
         67  traj.phases.descent.indep_states.states:v_2        c    -1.000000E+21     8.882067E+01     1.000000E+21           
         68  traj.phases.descent.indep_states.states:v_3        c    -1.000000E+21     9.346816E+01     1.000000E+21           
         69  traj.phases.descent.indep_states.states:v_4        c    -1.000000E+21     9.974896E+01     1.000000E+21           
         70  traj.phases.descent.indep_states.states:v_5        c    -1.000000E+21     1.052110E+02     1.000000E+21           
         71  traj.phases.descent.indep_states.states:gam_0      c    -1.000000E+21    -3.604294E-19     1.000000E+21           
         72  traj.phases.descent.indep_states.states:gam_1      c    -1.000000E+21    -3.251993E-01     1.000000E+21           
         73  traj.phases.descent.indep_states.states:gam_2      c    -1.000000E+21    -6.399004E-01     1.000000E+21           
         74  traj.phases.descent.indep_states.states:gam_3      c    -1.000000E+21    -8.903150E-01     1.000000E+21           
         75  traj.phases.descent.indep_states.states:gam_4      c    -1.000000E+21    -1.071878E+00     1.000000E+21           
         76  traj.phases.descent.indep_states.states:gam_5      c    -1.000000E+21    -1.201236E+00     1.000000E+21           
         77  traj.phases.descent.indep_states.states:h_0        c    -1.000000E+21     9.496352E+02     1.000000E+21           
         78  traj.phases.descent.indep_states.states:h_1        c    -1.000000E+21     9.013842E+02     1.000000E+21           
         79  traj.phases.descent.indep_states.states:h_2        c    -1.000000E+21     7.675073E+02     1.000000E+21           
         80  traj.phases.descent.indep_states.states:h_3        c    -1.000000E+21     5.626946E+02     1.000000E+21           
         81  traj.phases.descent.indep_states.states:h_4        c    -1.000000E+21     3.019008E+02     1.000000E+21           
         82  traj.phases.descent.indep_states.states:r_0        c    -1.000000E+21     2.111144E+03     1.000000E+21           
         83  traj.phases.descent.indep_states.states:r_1        c    -1.000000E+21     2.417408E+03     1.000000E+21           
         84  traj.phases.descent.indep_states.states:r_2        c    -1.000000E+21     2.670896E+03     1.000000E+21           
         85  traj.phases.descent.indep_states.states:r_3        c    -1.000000E+21     2.881159E+03     1.000000E+21           
         86  traj.phases.descent.indep_states.states:r_4        c    -1.000000E+21     3.053363E+03     1.000000E+21           
         87  traj.phases.descent.indep_states.states:r_5        c    -1.000000E+21     3.191839E+03     1.000000E+21           

   Constraints (i - inequality, e - equality)
      Index  Name                                                     Type          Lower           Value           Upper    Status
          0  traj.phases.ascent.collocation_constraint.defects:v         e   0.000000E+00    4.690522E-08    0.000000E+00          
          1  traj.phases.ascent.collocation_constraint.defects:v         e   0.000000E+00    1.633605E-08    0.000000E+00          
          2  traj.phases.ascent.collocation_constraint.defects:v         e   0.000000E+00    6.588892E-09    0.000000E+00          
          3  traj.phases.ascent.collocation_constraint.defects:v         e   0.000000E+00    4.751056E-09    0.000000E+00          
          4  traj.phases.ascent.collocation_constraint.defects:v         e   0.000000E+00    2.843850E-09    0.000000E+00          
          5  traj.phases.ascent.collocation_constraint.defects:v         e   0.000000E+00    1.628338E-09    0.000000E+00          
          6  traj.phases.ascent.collocation_constraint.defects:v         e   0.000000E+00    1.387505E-09    0.000000E+00          
          7  traj.phases.ascent.collocation_constraint.defects:v         e   0.000000E+00    1.008666E-09    0.000000E+00          
          8  traj.phases.ascent.collocation_constraint.defects:v         e   0.000000E+00    6.940026E-10    0.000000E+00          
          9  traj.phases.ascent.collocation_constraint.defects:v         e   0.000000E+00    6.228059E-10    0.000000E+00          
         10  traj.phases.ascent.collocation_constraint.defects:v         e   0.000000E+00    4.946974E-10    0.000000E+00          
         11  traj.phases.ascent.collocation_constraint.defects:v         e   0.000000E+00    3.694136E-10    0.000000E+00          
         12  traj.phases.ascent.collocation_constraint.defects:v         e   0.000000E+00    3.376158E-10    0.000000E+00          
         13  traj.phases.ascent.collocation_constraint.defects:v         e   0.000000E+00    2.755489E-10    0.000000E+00          
         14  traj.phases.ascent.collocation_constraint.defects:v         e   0.000000E+00    2.069581E-10    0.000000E+00          
         15  traj.phases.ascent.collocation_constraint.defects:gam       e   0.000000E+00    1.708196E-12    0.000000E+00          
         16  traj.phases.ascent.collocation_constraint.defects:gam       e   0.000000E+00    1.094897E-12    0.000000E+00          
         17  traj.phases.ascent.collocation_constraint.defects:gam       e   0.000000E+00    8.018068E-13    0.000000E+00          
         18  traj.phases.ascent.collocation_constraint.defects:gam       e   0.000000E+00    6.294114E-13    0.000000E+00          
         19  traj.phases.ascent.collocation_constraint.defects:gam       e   0.000000E+00    4.766978E-13    0.000000E+00          
         20  traj.phases.ascent.collocation_constraint.defects:gam       e   0.000000E+00    3.610275E-13    0.000000E+00          
         21  traj.phases.ascent.collocation_constraint.defects:gam       e   0.000000E+00    3.301525E-13    0.000000E+00          
         22  traj.phases.ascent.collocation_constraint.defects:gam       e   0.000000E+00    2.907372E-13    0.000000E+00          
         23  traj.phases.ascent.collocation_constraint.defects:gam       e   0.000000E+00    2.734866E-13    0.000000E+00          
         24  traj.phases.ascent.collocation_constraint.defects:gam       e   0.000000E+00    2.719029E-13    0.000000E+00          
         25  traj.phases.ascent.collocation_constraint.defects:gam       e   0.000000E+00    2.781267E-13    0.000000E+00          
         26  traj.phases.ascent.collocation_constraint.defects:gam       e   0.000000E+00    2.894644E-13    0.000000E+00          
         27  traj.phases.ascent.collocation_constraint.defects:gam       e   0.000000E+00    2.895532E-13    0.000000E+00          
         28  traj.phases.ascent.collocation_constraint.defects:gam       e   0.000000E+00    2.785560E-13    0.000000E+00          
         29  traj.phases.ascent.collocation_constraint.defects:gam       e   0.000000E+00    2.206098E-13    0.000000E+00          
         30  traj.phases.ascent.collocation_constraint.defects:h         e   0.000000E+00    2.219881E-08    0.000000E+00          
         31  traj.phases.ascent.collocation_constraint.defects:h         e   0.000000E+00    1.043353E-08    0.000000E+00          
         32  traj.phases.ascent.collocation_constraint.defects:h         e   0.000000E+00    4.951347E-09    0.000000E+00          
         33  traj.phases.ascent.collocation_constraint.defects:h         e   0.000000E+00    3.512530E-09    0.000000E+00          
         34  traj.phases.ascent.collocation_constraint.defects:h         e   0.000000E+00    1.930396E-09    0.000000E+00          
         35  traj.phases.ascent.collocation_constraint.defects:h         e   0.000000E+00    8.102702E-10    0.000000E+00          
         36  traj.phases.ascent.collocation_constraint.defects:h         e   0.000000E+00    5.735290E-10    0.000000E+00          
         37  traj.phases.ascent.collocation_constraint.defects:h         e   0.000000E+00    2.156588E-10    0.000000E+00          
         38  traj.phases.ascent.collocation_constraint.defects:h         e   0.000000E+00   -4.574925E-11    0.000000E+00          
         39  traj.phases.ascent.collocation_constraint.defects:h         e   0.000000E+00   -9.539367E-11    0.000000E+00          
         40  traj.phases.ascent.collocation_constraint.defects:h         e   0.000000E+00   -1.569737E-10    0.000000E+00          
         41  traj.phases.ascent.collocation_constraint.defects:h         e   0.000000E+00   -1.703150E-10    0.000000E+00          
         42  traj.phases.ascent.collocation_constraint.defects:h         e   0.000000E+00   -1.605392E-10    0.000000E+00          
         43  traj.phases.ascent.collocation_constraint.defects:h         e   0.000000E+00   -1.221047E-10    0.000000E+00          
         44  traj.phases.ascent.collocation_constraint.defects:h         e   0.000000E+00   -3.447724E-11    0.000000E+00          
         45  traj.phases.ascent.collocation_constraint.defects:r         e   0.000000E+00    1.452627E-08    0.000000E+00          
         46  traj.phases.ascent.collocation_constraint.defects:r         e   0.000000E+00    8.945725E-09    0.000000E+00          
         47  traj.phases.ascent.collocation_constraint.defects:r         e   0.000000E+00    5.755448E-09    0.000000E+00          
         48  traj.phases.ascent.collocation_constraint.defects:r         e   0.000000E+00    4.839281E-09    0.000000E+00          
         49  traj.phases.ascent.collocation_constraint.defects:r         e   0.000000E+00    3.633598E-09    0.000000E+00          
         50  traj.phases.ascent.collocation_constraint.defects:r         e   0.000000E+00    2.559654E-09    0.000000E+00          
         51  traj.phases.ascent.collocation_constraint.defects:r         e   0.000000E+00    2.287690E-09    0.000000E+00          
         52  traj.phases.ascent.collocation_constraint.defects:r         e   0.000000E+00    1.794535E-09    0.000000E+00          
         53  traj.phases.ascent.collocation_constraint.defects:r         e   0.000000E+00    1.285708E-09    0.000000E+00          
         54  traj.phases.ascent.collocation_constraint.defects:r         e   0.000000E+00    1.152272E-09    0.000000E+00          
         55  traj.phases.ascent.collocation_constraint.defects:r         e   0.000000E+00    8.923112E-10    0.000000E+00          
         56  traj.phases.ascent.collocation_constraint.defects:r         e   0.000000E+00    6.092979E-10    0.000000E+00          
         57  traj.phases.ascent.collocation_constraint.defects:r         e   0.000000E+00    5.340772E-10    0.000000E+00          
         58  traj.phases.ascent.collocation_constraint.defects:r         e   0.000000E+00    3.850909E-10    0.000000E+00          
         59  traj.phases.ascent.collocation_constraint.defects:r         e   0.000000E+00    2.262076E-10    0.000000E+00          
         60  traj.phases.descent.collocation_constraint.defects:v        e   0.000000E+00    5.306409E-10    0.000000E+00          
         61  traj.phases.descent.collocation_constraint.defects:v        e   0.000000E+00    3.170473E-10    0.000000E+00          
         62  traj.phases.descent.collocation_constraint.defects:v        e   0.000000E+00    2.613840E-10    0.000000E+00          
         63  traj.phases.descent.collocation_constraint.defects:v        e   0.000000E+00    2.608862E-10    0.000000E+00          
         64  traj.phases.descent.collocation_constraint.defects:v        e   0.000000E+00    2.769328E-10    0.000000E+00          
         65  traj.phases.descent.collocation_constraint.defects:gam      e   0.000000E+00    9.805257E-14    0.000000E+00          
         66  traj.phases.descent.collocation_constraint.defects:gam      e   0.000000E+00    1.442465E-13    0.000000E+00          
         67  traj.phases.descent.collocation_constraint.defects:gam      e   0.000000E+00    3.705182E-13    0.000000E+00          
         68  traj.phases.descent.collocation_constraint.defects:gam      e   0.000000E+00    3.761717E-13    0.000000E+00          
         69  traj.phases.descent.collocation_constraint.defects:gam      e   0.000000E+00    2.761859E-13    0.000000E+00          
         70  traj.phases.descent.collocation_constraint.defects:h        e   0.000000E+00    4.444259E-11    0.000000E+00          
         71  traj.phases.descent.collocation_constraint.defects:h        e   0.000000E+00    1.807397E-10    0.000000E+00          
         72  traj.phases.descent.collocation_constraint.defects:h        e   0.000000E+00    2.742631E-10    0.000000E+00          
         73  traj.phases.descent.collocation_constraint.defects:h        e   0.000000E+00    3.351925E-10    0.000000E+00          
         74  traj.phases.descent.collocation_constraint.defects:h        e   0.000000E+00    4.086209E-10    0.000000E+00          
         75  traj.phases.descent.collocation_constraint.defects:r        e   0.000000E+00    8.134668E-11    0.000000E+00          
         76  traj.phases.descent.collocation_constraint.defects:r        e   0.000000E+00   -1.545909E-10    0.000000E+00          
         77  traj.phases.descent.collocation_constraint.defects:r        e   0.000000E+00   -2.989847E-10    0.000000E+00          
         78  traj.phases.descent.collocation_constraint.defects:r        e   0.000000E+00   -4.418018E-10    0.000000E+00          
         79  traj.phases.descent.collocation_constraint.defects:r        e   0.000000E+00   -5.632464E-10    0.000000E+00          
         80  traj.linkages.ascent|descent_v                              e   0.000000E+00    0.000000E+00    0.000000E+00          
         81  traj.linkages.ascent|descent_gam                            e   0.000000E+00   -3.604294E-19    0.000000E+00          
         82  traj.linkages.ascent|descent_h                              e   0.000000E+00    0.000000E+00    0.000000E+00          
         83  traj.linkages.ascent|descent_time                           e   0.000000E+00   -1.776357E-15    0.000000E+00          
         84  traj.linkages.ascent|descent_r                              e   0.000000E+00    0.000000E+00    0.000000E+00          
         85  traj.phases.ascent.boundary_constraints.initial_value:ke    i   0.000000E+00    4.000000E+00    4.000000E+00         u

--------------------------------------------------------------------------------

[3191.83945861]
/home/travis/build/OpenMDAO/dymos/OpenMDAO/openmdao/core/group.py:977: UserWarning:Output &#x27;traj.phases.ascent.rhs_all.kinetic_energy.ke&#x27; with units of &#x27;J&#x27; is connected to input &#x27;traj.phases.ascent.boundary_constraints.boundary_values:ke&#x27; which has no units.
/home/travis/build/OpenMDAO/dymos/dymos/models/atmosphere/sos_comp.py:35: RuntimeWarning: divide by zero encountered in true_divide
  partials[&#x27;sos&#x27;, &#x27;temp&#x27;] = 0.5 * self.K / sos
simulating  descent
descent simulation complete
simulating  ascent
ascent simulation complete
Recording Results to ex_two_phase_cannonball_sim.db...Done
optimal radius: 0.0418 m 
cannonball mass: 2.4103 kg 
</pre></div></div><div class="figure">
<img alt="../_images/doc_plot_4.png" src="../_images/doc_plot_4.png" />
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="two_burn_orbit_raise.html" title="Two-Burn Orbit Raise"
             >next</a> |</li>
        <li class="right" >
          <a href="commercial_aircraft.html" title="Commercial Aircraft Range Maximization by Differential Inclusion"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">dymos 0.11.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="examples.html" >Examples</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, National Aeronautics and Space Administration.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.8.
    </div>
  </body>
</html>